from dataclasses import dataclass
from typing import Literal, Optional, Set

input = """
#.###########################################################################################################################################
#...#...#...###...###...#...#...#...#...###...#...#####.....#.............#.....#...#...###.......#...#.....#####...#...#####...#...###...###
###.#.#.#.#.###.#.###.#.#.#.#.#.#.#.#.#.###.#.#.#.#####.###.#.###########.#.###.#.#.#.#.###.#####.#.#.#.###.#####.#.#.#.#####.#.#.#.###.#.###
###.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#...#...#.###...#...#.....#.......#...#...#.#.#.#...#.....#.#.#...#.#.....#...#.......#...#.#...#...#
###.#.#v#.###.#.###.#.#.#.#.#.#.#.#.#.#.#.#######.###.###.#######.#.#########.#####.#.#.#.###.#####.#.###.#.#.#####################.#.#####.#
###...#.>.#...#.#...#.#.#.#.#.#.#.#.#.#.#.......#...#...#.>.>.###.#.#...#...#.#.....#.#.#...#.#####.#.#...#.#...#...#...#.........#.#.#.....#
#######v###.###.#.###.#.#.#.#.#.#.#.#.#.#######.###.###.###v#.###.#.#.#.#.#.#.#.#####.#.###.#.#####.#.#.###.###.#.#.#.#.#.#######.#.#.#.#####
#...#...###.....#...#.#.#.#.#.#.#.#.#.#.#.....#...#.#...#...#.....#...#.#.#.#.#.#.....#.>.>.#...#...#.#...#.....#.#...#...#.....#...#.#.#...#
#.#.#.#############.#.#.#.#.#.#.#.#.#.#.#.###.###.#.#.###.#############.#.#.#.#.#.#######v#####.#.###.###.#######.#########.###.#####.#.#.#.#
#.#...#...###.......#.#.#.#.#.#.#.#.#.#.#...#.#...#...###...#...#...#...#.#...#...###...#.###...#...#.###.......#.#...#...#.#...#...#.#.#.#.#
#.#####.#.###.#######.#.#.#.#.#.#.#.#.#.###.#.#.###########.#.#.#.#.#.###.###########.#.#.###.#####.#.#########.#.#.#.#.#.#.#.###.#.#.#.#.#.#
#...#...#...#.#.....#.#.#.#.#.#.#.#.#.#.#...#.#...........#.#.#...#.#...#.#.........#.#.#...#.#...#.#...#...>.>.#...#...#.#.#...#.#.#.#.#.#.#
###.#.#####.#.#.###.#.#.#.#.#.#.#.#.#.#.#.###.###########.#.#.#####.###.#.#.#######.#.#.###.#.#.#.#.###.#.###v###########.#.###.#.#.#.#.#.#.#
###.#.#.....#.#.#...#.#.#.#.#.#.#.#.#.#.#...#.#...#.....#.#.#.#.....###...#.......#.#.#.#...#.#.#.#...#...#...#.........#.#.#...#.#.#.#.#.#.#
###.#.#.#####.#.#.###.#.#.#.#.#.#.#.#.#.###.#.#.#.#.###.#.#.#.#.#################.#.#.#.#.###.#.#.###.#####.###.#######.#.#.#.###.#.#.#.#.#.#
###...#.....#.#.#...#.#...#.#.#.#.#.#.#.>.>.#.#.#.#...#...#...#...........#.......#...#...#...#.#.#...#...#...#...#...#...#.#.#...#.#.#.#.#.#
###########.#.#.###.#.#####.#.#.#.#.#.###v###.#.#.###.###################.#.###############.###.#.#.###.#.###.###.#.#.#####.#.#.###.#.#.#.#.#
#...........#...#...#.....#.#.#...#...#...###.#.#.#...#...................#.............#...#...#.#...#.#.....###.#.#.....#.#.#.#...#.#...#.#
#.###############.#######.#.#.#########.#####.#.#.#.###.###############################.#.###.###.###.#.#########.#.#####.#.#.#.#.###.#####.#
#...............#...#...#.#...###...#...#...#...#...###...................#.............#.....###.....#.........#.#...#...#.#.#.#...#.#.....#
###############.###.#.#.#.#######.#.#.###.#.#############################.#.###################################.#.###.#.###.#.#.###.#.#.#####
#...............#...#.#...###.....#...###.#.###...#####...#...........#...#.#.......#...#.......###...#...#...#.#.#...#...#.#.#.#...#.#.....#
#.###############.###.#######.###########.#.###.#.#####.#.#.#########.#.###.#.#####.#.#.#.#####.###.#.#.#.#.#.#.#.#.#####.#.#.#.#.###.#####.#
#.......#.......#...#...#.....#.......###.#.#...#...#...#.#.........#...###...#.....#.#.#.....#.#...#.#.#...#...#...#.....#.#.#.#...#.#.....#
#######.#.#####.###.###.#.#####.#####.###.#.#.#####.#.###.#########.###########.#####.#.#####.#.#.###.#.#############.#####.#.#.###.#.#.#####
#.......#.#.....###.#...#...#...#.....#...#.#.....#.#.#...#####...#.......#...#.....#.#.#...#.#.#.#...#.........#...#...#...#...###...#.....#
#.#######.#.#######.#.#####.#.###.#####.###.#####.#.#.#.#######.#.#######.#.#.#####.#.#.#.#.#.#.#.#.###########.#.#.###.#.#################.#
#.#...#...#...#...#...#...#...#...###...#...#.....#.#.#.....#...#.........#.#.###...#.#.#.#.#.#.#.#.#...###.....#.#.###...###.........###...#
#.#.#.#.#####v#.#.#####.#.#####.#####.###.###.#####.#.#####.#.#############.#.###.###.#.#.#.#.#.#.#.#.#.###v#####.#.#########.#######.###.###
#...#.#.#...#.>.#...#...#.#...#.....#.#...###.....#...#.....#...#.........#.#.#...###.#.#.#.#.#.#.#...#...>.>.###.#.#...#...#.......#.....###
#####.#.#.#.#v#####.#.###.#.#.#####.#.#.#########.#####.#######.#.#######.#.#.#.#####.#.#.#.#.#.#.#########v#.###.#.#.#.#.#.#######.#########
#...#...#.#...#.....#...#.#.#.......#.#.#...#...#...#...###...#.#.#.......#.#.#...#...#...#.#.#...#.........#...#.#.#.#.#.#.#...###.........#
#.#.#####.#####.#######.#.#.#########.#.#.#.#.#.###.#.#####.#.#v#.#.#######.#.###.#.#######.#.#####.###########.#.#.#.#.#.#.#.#.###########.#
#.#.......#...#...#####.#.#.......#...#.#.#.#.#...#.#...#...#.>.>.#...#...#.#.###.#.......#.#...###...#.......#.#.#.#.#.#.#...#...#.........#
#.#########.#.###.#####.#.#######v#.###.#.#.#.###.#.###.#.#####v#####.#.#.#.#.###v#######.#.###.#####.#.#####.#.#.#.#.#.#.#######.#.#########
#.#.......#.#...#...#...#.......>.>.###...#...#...#...#...###...#...#...#.#.#...>.>.......#...#.#...#...#...#.#.#.#.#.#...#.......#.........#
#.#.#####.#.###.###.#.###########v#############.#####.#######.###.#.#####.#.#####v###########.#.#.#.#####.#.#.#.#.#.#.#####.###############.#
#...#...#.#.#...###...#...........###.......###.#.....#.......###.#.......#...###.........###...#.#.......#.#.#.#.#...#.....#...#...........#
#####.#.#.#.#.#########.#############.#####.###.#.#####.#########.###########.###########.#######.#########.#.#.#.#####.#####.#.#.###########
#...#.#.#...#.......###...............#.....#...#.#...#.........#.....#...#...#...........#...###.......###...#...#.....#...#.#.#.........###
#.#.#.#.###########.###################.#####.###.#.#.#########.#####.#.#.#.###.###########.#.#########.###########.#####.#.#.#.#########v###
#.#...#.............#...#...#.....#...#...###...#.#.#...........#...#...#...###.........#...#.#.......#.......#.....#...#.#.#.#...#.....>.###
#.###################.#.#.#.#.###.#.#.###.#####.#.#.#############.#.###################.#.###.#.#####.#######.#.#####.#.#.#.#.###.#.#####v###
#.#.....#...#...#.....#...#.#...#...#...#.....#.#.#...#...#.......#...#.....###...#...#.#...#.#.#...#.........#.....#.#.#.#.#.#...#.#.....###
#.#.###.#.#.#.#.#.#########.###.#######.#####.#.#.###.#.#.#.#########.#.###.###.#.#.#.#.###.#.#.#.#.###############.#.#.#.#.#.#.###.#.#######
#.#.#...#.#...#...#.........###.......#...#...#...###...#...#...#...#.#...#.....#...#...#...#.#...#.#.......#.......#.#.#.#...#...#.#.......#
#.#.#.###.#########.#################.###.#.#################.#.#.#.#.###.###############.###.#####.#.#####.#.#######.#.#.#######.#.#######.#
#.#.#...#.#.........#...#...#.........###...#...###...###.....#...#...#...#...........###...#.#.....#.#.....#.......#.#...###...#.#.#.......#
#.#.###.#.#.#########.#.#.#.#.###############.#.###.#.###.#############.###.#########.#####.#.#.#####.#.###########.#.#######.#.#.#.#.#######
#.#...#...#...........#...#.#.........#.....#.#.#...#.....###...#...###.....#...#.....#...#.#.#...#...#.#...#.....#.#.#.....#.#.#...#.......#
#.###.#####################.#########.#.###.#.#.#.###########.#.#.#.#########.#.#.#####.#.#.#.###.#.###.#.#.#.###.#.#.#.###.#.#.###########.#
#.....###...................#.........#...#...#.#.........#...#...#...#...#...#...#...#.#...#.###...###...#...#...#...#...#.#.#.###...#.....#
#########.###################.###########.#####.#########.#.#########.#.#.#.#######.#.#.#####.#################.#########.#.#.#.###.#.#.#####
#.....#...#...#.....#...#...#...#...#...#.....#.#...#...#.#.#...#.....#.#.#...###...#.#...#...#...#...#.........#...#.....#.#.#.#...#.#.....#
#.###.#.###.#.#.###.#.#.#.#.###.#.#.#.#.#####.#.#.#.#.#.#v#.#.#.#.#####.#.###.###.###.###.#.###.#.#.#.#v#########.#.#.#####.#.#.#.###.#####.#
#...#.#.....#...#...#.#.#.#.....#.#.#.#.#...#.#.#.#...#.>.>.#.#...#.....#.###...#...#...#.#...#.#.#.#.>.>...#...#.#.#.....#.#.#.#...#.###...#
###.#.###########v###.#.#.#######.#.#.#.#.#.#.#.#.#######v###.#####.#####.#####.###.###.#.###.#.#.#.###v###.#.#.#.#.#####.#.#.#.###.#.###v###
#...#...........#.>.#.#.#.......#.#.#.#.#.#...#.#.....#...###...###.....#.#.....###...#...#...#.#.#.###...#.#.#.#.#...#...#.#.#.#...#.#.>.###
#.#############.#v#.#.#.#######v#.#.#.#.#.#####.#####.#.#######.#######.#.#v#########.#####.###.#.#.#####.#.#.#.#.###.#.###.#.#.#.###.#.#v###
#.............#.#.#.#.#.#...#.>.>.#...#.#.###...#.....#.....###...#...#.#.>.>.#...#...#.....#...#.#.#.....#...#.#.#...#.#...#.#.#.###.#.#...#
#############.#.#.#.#.#.#.#.#.#v#######.#.###.###.#########.#####.#.#.#.###v#.#.#.#.###.#####.###.#.#.#########.#.#.###.#.###.#.#.###.#.###.#
###...#.....#.#...#.#.#.#.#.#.#.###.....#...#...#...#.......#.....#.#.#.#...#...#...###.....#...#...#.....#...#...#.#...#...#.#.#...#...#...#
###.#.#.###.#.#####.#.#.#.#.#.#.###.#######.###.###.#.#######.#####.#.#.#.#################.###.#########.#.#.#####.#.#####.#.#.###.#####.###
#...#...#...#.....#...#...#.#.#...#.........###.....#.......#.#...#.#.#.#.#...#####...#...#.....###...###...#.....#...#...#.#.#.#...###...###
#.#######.#######.#########.#.###.#########################.#.#.#.#.#.#.#.#.#.#####.#.#.#.#########.#.###########.#####.#.#.#.#.#.#####.#####
#.......#.#.....#.....#.....#...#...###.....#.....#.........#...#.#.#.#.#.#.#...###.#...#.....#.....#.............#.....#.#...#...#...#.....#
#######.#.#.###.#####.#.#######.###.###.###.#.###.#.#############.#.#.#.#.#.###.###.#########.#.###################.#####.#########.#.#####.#
#.......#.#...#.#...#.#.....#...###...#.#...#.#...#...........#...#.#...#...###.....#...#.....#.....#.....###.......#...#...#...#...#.......#
#.#######.###.#.#.#.#.#####.#.#######.#.#.###.#.#############.#.###.#################.#.#.#########.#.###.###.#######.#.###.#.#.#.###########
#.......#.....#...#...#.....#.#...#...#.#.....#...#...........#.....###...#...........#...#.....###...###...#.#.......#.....#.#.#...........#
#######.###############.#####.#.#.#.###.#########.#.###################.#.#.###############.###.###########.#.#.#############.#.###########.#
###...#...............#.#...#...#.#...#.#.........#.....................#.#.....#.........#...#.......#...#...#...#.........#.#.....#.......#
###.#.###############.#.#.#.#####.###.#.#.###############################.#####.#.#######.###.#######.#.#.#######.#.#######.#.#####.#.#######
#...#.................#...#...#...###...#.......#...#.................#...#...#.#.#.......#...#.......#.#.#.......#...#.....#.....#...#...###
#.###########################.#.###############.#.#.#.###############.#.###.#.#.#.#.#######.###.#######.#.#.#########.#.#########.#####.#.###
#.......................###...#.#.....#...#...#.#.#.#.......#...#...#...###.#.#...#.#.....#...#.#...#...#.#.......#...#...#.....#.......#...#
#######################.###.###.#.###.#.#.#.#.#.#.#.#######.#.#.#.#.#######.#.#####.#.###.###.#.#.#.#.###.#######.#.#####.#.###.###########.#
#.......................#...#...#...#...#...#.#...#.#.......#.#.#.#...#...#.#.#...#.#.#...###.#.#.#.#...#.###.....#.#.....#.#...#...#...#...#
#.#######################.###.#####.#########.#####.#.#######.#.#.###.#.#.#.#.#.#.#.#.#.#####.#.#.#.###.#.###v#####.#.#####.#.###.#.#.#.#v###
#...............#.....###.....#...#.........#.......#.......#.#.#...#...#.#.#.#.#.#...#.###...#.#.#.#...#...>.>.#...#...#...#.#...#.#.#.>.###
###############.#.###.#########.#.#########.###############.#.#.###.#####.#.#.#.#.#####.###.###.#.#.#.#######v#.#.#####.#.###.#.###.#.###v###
###...#...#.....#.#...#...#.....#.#.....#...###...###...#...#.#.###.#.....#.#.#.#.#...#.#...#...#.#.#...#.....#.#.#.....#...#...###...###...#
###.#.#.#.#.#####.#.###.#.#.#####.#.###.#.#####.#.###.#.#v###.#.###.#.#####.#.#.#.#.#.#v#.###.###.#.###.#.#####.#.#.#######.###############.#
#...#...#...#.....#...#.#...#.....#...#.#...#...#.#...#.>.>...#.#...#.#...#.#.#.#.#.#.>.>.###.....#.....#.....#.#.#.........#...#...#.....#.#
#.###########.#######.#.#####.#######.#.###.#.###.#.#####v#####.#.###.#.#.#.#.#.#.#.###v#####################.#.#.###########.#.#.#.#.###.#.#
#...#...#...#.#.......#.....#.#.....#.#.###...#...#...#...#...#...#...#.#...#.#.#.#...#.......###...#.....#...#.#.#.........#.#...#.#...#.#.#
###.#.#.#.#v#.#.###########.#.#.###.#.#.#######.#####.#.###.#.#####.###.#####.#.#.###.#######.###.#.#.###.#.###.#.#.#######.#.#####.###.#.#.#
#...#.#...#.>.#.#...###...#.#.#...#.#.#.###.....#.....#.....#.....#.....#...#.#.#.....#...#...#...#...###...###...#...#...#...#...#.#...#.#.#
#.###.#####v###.#.#.###.#.#.#.###.#.#.#.###v#####.###############.#######.#.#.#.#######.#.#.###.#####################.#.#.#####.#.#.#.###.#.#
#.....#...#.#...#.#...#.#.#.#.#...#.#.#...>.>...#...###...#...#...#.......#...#.###...#.#...###...................###...#.#.....#.#...###.#.#
#######.#.#.#.###.###.#.#.#.#.#.###.#.#####v###.###.###.#.#.#.#.###.###########.###.#.#.#########################.#######.#.#####.#######.#.#
#.......#...#.....###.#.#.#.#.#...#.#.#.....###.....#...#...#...###.......#...#.#...#...#...###...................#...###...#...#.......#.#.#
#.###################.#.#.#.#.###.#.#.#.#############.###################.#.#.#.#.#######.#.###.###################.#.#######.#.#######.#.#.#
#...........#...#...#.#.#...#.#...#...#.........#...#.........#...###...#...#...#...#.....#...#...........#.....#...#...#...#.#.....#...#.#.#
###########.#.#.#.#.#.#.#####.#.###############.#.#.#########.#.#.###.#.###########.#.#######.###########.#.###.#.#####.#.#.#.#####.#.###.#.#
#...........#.#...#.#.#...#...#...#...#.........#.#.#.......#.#.#.#...#.###.....###...#.....#.#...........#.#...#.....#...#.#.....#...###...#
#.###########.#####.#.###.#.#####.#.#.#.#########.#.#.#####.#.#.#.#.###.###.###.#######.###.#.#.###########.#.#######.#####.#####.###########
#.#.........#.###...#.....#.......#.#.#.......#...#...#...#...#.#.#...#.#...#...#.......###...#.#.....#.....#.#...###...#...#.....#.....#...#
#.#.#######.#.###.#################.#.#######.#.#######.#.#####.#.###.#.#.###.###.#############.#.###.#.#####.#.#.#####.#.###.#####.###.#.#.#
#.#.#.......#.#...#.....#...#.....#.#.###.....#...#.....#...###.#.#...#.#...#.###.........#...#.#.#...#.#.....#.#.#...#.#.###.....#...#.#.#.#
#.#.#.#######.#.###.###.#.#.#.###.#.#.###v#######.#.#######.###.#.#.###.###.#.###########.#.#.#.#.#.###.#.#####.#.#.#.#.#.#######.###.#.#.#.#
#...#.......#.#.....#...#.#.#...#...#...>.>.#...#...#.......#...#.#.#...#...#.#.....#.....#.#.#.#.#...#.#.#...#.#.#.#.#.#.#...#...#...#.#.#.#
###########.#.#######.###.#.###.#########v#.#.#.#####.#######.###.#.#.###.###.#.###.#.#####.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#v###.###.#.#.#
#...###...#...###...#...#.#...#...###.....#.#.#...#...###...#...#.#.#.###...#.#...#.#...###.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.>.###...#.#.#.#
#.#.###.#.#######.#.###.#.###.###.###.#####.#.###.#.#####.#.###.#.#.#.#####.#.###.#.###v###.#.#####v###.#.#.#.#.#.#.#.#.#.#.###v#####.#.#.#.#
#.#.....#.........#...#.#...#.....#...#...#...#...#...#...#...#.#.#.#...#...#...#.#...>.>...#.#...>.>...#...#...#.#.#.#.#.#.#...###...#...#.#
#.###################.#.###.#######.###.#.#####.#####v#.#####.#.#.#.###.#.#####.#.#####v#####.#.###v#############.#.#.#.#.#.#.#####.#######.#
#.....#.....#.......#...###.......#.....#.....#...#.>.>.#####...#...#...#...#...#.#.....#.....#...#...###.......#...#...#.#.#.....#.#.......#
#####.#.###.#.#####.#############.###########.###.#.#v###############.#####.#.###.#.#####.#######.###.###.#####.#########.#.#####.#.#.#######
#...#...###.#.###...###...#.......#...........###.#.#.#...###...#...#.......#.#...#.....#.#.....#...#...#.#.....#.........#.#...#.#.#...#...#
#.#.#######.#.###v#####.#.#.#######.#############.#.#.#.#.###.#.#.#.#########.#.#######.#.#.###.###.###.#.#.#####.#########.#.#.#.#.###.#.#.#
#.#...#...#...###.>...#.#.#...#...#.........#.....#.#.#.#.....#...#.........#.#.#...#...#...###...#.#...#.#.....#.........#.#.#...#.#...#.#.#
#.###.#.#.#######v###.#.#.###.#.#.#########.#.#####.#.#.###################.#.#.#.#.#.###########.#.#.###.#####.#########.#.#.#####.#.###.#.#
#.#...#.#.#...###...#.#.#.#...#.#.....#...#.#...#...#...#...............#...#...#.#.#.....#...###...#...#.#.....#.....#...#.#.....#.#.....#.#
#.#.###.#.#.#.#####.#.#.#.#.###.#####.#.#.#.###.#.#######.#############.#.#######.#.#####.#.#.#########.#.#.#####.###.#.###.#####.#.#######.#
#.#.....#.#.#.#.....#...#.#.###.#...#...#...###...#...###.............#...#...#...#...#...#.#.#.....###...#...#...#...#...#.#...#.#.#.......#
#.#######.#.#.#.#########.#.###.#.#.###############.#.###############.#####.#.#.#####.#.###.#.#.###.#########.#.###.#####.#.#.#.#.#.#.#######
#...#...#.#.#.#.......###...###...#.......###...#...#.#.....###.......###...#.#.#...#.#.###.#...#...#...#...#...#...#####...#.#.#...#.....###
###.#.#.#.#.#.#######.###################.###.#.#.###.#.###.###.#########.###.#.#.#.#.#.###.#####.###.#.#.#.#####.###########.#.#########.###
#...#.#.#...#.......#.....#...............#...#...#...#...#.#...#...#...#.#...#...#.#...#...#.....#...#.#.#.......#...#...#...#...#.....#...#
#.###.#.###########.#####.#.###############.#######.#####.#.#.###.#.#.#.#.#.#######.#####.###.#####.###.#.#########.#.#.#.#.#####.#.###.###.#
#.#...#...........#.......#...............#.......#.....#.#.#.....#.#.#.#.#.#.....#.#...#.#...#...#...#.#.........#.#.#.#.#...#...#...#.....#
#.#.#############.#######################.#######.#####.#.#.#######.#.#.#.#.#.###.#.#.#.#.#.###.#.###.#.#########v#.#.#.#.###.#.#####.#######
#.#.#...........#...#.....#...............#.....#.#.....#.#.###.....#.#.#.#.#.#...#.#.#.#.#.#...#.#...#...#...#.>.>.#.#.#.#...#.....#.......#
#.#.#.#########.###.#.###.#.###############.###.#.#.#####.#.###v#####.#.#.#.#.#.###v#.#.#.#.#.###.#.#####.#.#.#.#####.#.#.#.#######.#######.#
#.#.#.........#.....#.#...#...............#...#.#.#.#.....#.#.>.>.#...#.#.#...#.#.>.>.#.#.#.#.#...#.#.....#.#.#.#####.#.#.#...#.....#.......#
#.#.#########.#######.#.#################.###.#.#.#.#.#####.#.###.#.###.#.#####.#.#####.#.#.#.#.###.#.#####.#.#.#####.#.#.###.#.#####.#######
#...#.........#.......#...#...###...###...#...#...#.#.....#.#.#...#...#.#.#.....#.#...#...#...#...#.#.....#.#...#.....#.#.....#...###.......#
#####.#########.#########.#.#.###.#.###.###.#######.#####.#.#.#.#####.#.#.#.#####.#.#.###########.#.#####.#.#####.#####.#########.#########.#
#.....#.........###.......#.#.....#.....###.......#...#...#.#.#...#...#...#.....#...#...#...###...#.....#.#.....#.....#.###...###...#...#...#
#.#####.###########.#######.#####################.###.#.###.#.###.#.###########.#######.#.#.###.#######.#.#####.#####.#.###.#.#####.#.#.#v###
#.......#.........#.#...###.............###...#...#...#...#...#...#.......#.....#.....#...#...#.....#...#.......#.....#...#.#.......#.#.>.###
#########.#######.#.#.#.###############v###.#.#.###.#####.#####.#########.#.#####.###.#######.#####.#.###########.#######.#.#########.###v###
#.......#...#...#...#.#...#.....#...#.>.>.#.#.#...#.#...#.....#...#...#...#...#...###.#...#...###...#.#...........#...#...#...#...#...#...###
#.#####.###.#.#.#####.###.#.###.#.#.#.###.#.#.###.#.#.#.#####.###.#.#.#.#####.#.#####.#.#.#.#####.###.#.###########.#.#.#####.#.#.#.###.#####
#.....#.....#.#.#...#.###.#...#.#.#.#.###.#.#.#...#.#.#...#...#...#.#.#.###...#.....#.#.#.#.....#.#...#.#.....#...#.#.#.#.....#.#.#.###.....#
#####.#######.#.#.#.#.###.###.#.#.#.#.###.#.#.#.###.#.###.#.###.###.#.#.###.#######.#.#.#.#####.#.#.###.#.###.#.#.#.#.#.#.#####.#.#.#######.#
#.....#.....#.#.#.#.#.#...#...#.#.#.#...#.#.#.#.#...#...#.#...#...#.#.#.#...#...#...#.#.#.#...#.#.#...#.#.#...#.#.#.#.#.#...#...#.#.#.......#
#.#####.###.#.#.#.#.#.#.###.###.#.#.###.#.#.#.#.#.#####.#.###.###.#.#.#.#.###.#.#.###.#.#.#.#.#.#.###.#.#.#.###.#.#.#.#.###.#.###.#.#.#######
#.......###...#...#...#.....###...#.....#...#...#.......#.....###...#...#.....#...###...#...#...#.....#...#.....#...#...###...###...#.......#
###########################################################################################################################################.#
"""


input = """
#.#####################
#.......#########...###
#######.#########.#.###
###.....#.>.>.###.#.###
###v#####.#v#.###.#.###
###.>...#.#.#.....#...#
###v###.#.#.#########.#
###...#.#.#.......#...#
#####.#.#.#######.#.###
#.....#.#.#.......#...#
#.#####.#.#.#########v#
#.#...#...#...###...>.#
#.#.#v#######v###.###v#
#...#.>.#...>.>.#.###.#
#####v#.#.###v#.#.###.#
#.....#...#...#.#.#...#
#.#########.###.#.#.###
#...###...#...#...#.###
###.###.#.###v#####v###
#...#...#.#.>.>.#.>.###
#.###.###.#.###.#.#v###
#.....###...###...#...#
#####################.#
"""


board = [*map(lambda x: list(x), input.strip().split("\n"))
         ]


@dataclass
class Node:
    r: int
    c: int
    path: Set["Node"]

    @property
    def coords(self):
        return self.r, self.c


open_list = [Node(0, 1, set())]


def in_bounds(x, y):
    return 0 <= x < len(board[0]) and 0 <= y < len(board)


def print_path(path):
    out = ""
    for r, row in enumerate(board):
        for c, col in enumerate(row):
            if (r, c) in path:
                out += "O"
            else:
                out += col
        out += "\n"
    print(out)


max_len = 0
while open_list:
    node = open_list.pop(0)
    r, c = node.r, node.c

    if not in_bounds(r, c):
        continue  # Out of bounds

    if board[r][c] == "#":
        continue  # Wall

    if node.coords in node.path:
        continue  # Avoid loops

    if r == len(board) - 1:
        print("Found path", len(node.path))
        max_len = max(max_len, len(node.path))
        continue

    new_path = node.path.copy()
    new_path.add(node.coords)

    up = Node(r - 1, c, new_path)
    down = Node(r + 1, c, new_path)
    left = Node(r, c - 1, new_path)
    right = Node(r, c + 1, new_path)
    open_list.append(up)
    open_list.append(down)
    open_list.append(left)
    open_list.append(right)


print(max_len)
